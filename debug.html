<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ä–æ–∫–∞ –≥–æ–¥–Ω–æ—Å—Ç–∏</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-800 mb-8">üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h1>
        
        <div class="grid gap-6">
            <!-- –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4">üìä –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
                <div id="appStatus" class="space-y-2">
                    <div class="flex justify-between">
                        <span>URL data.json:</span>
                        <span id="dataUrl" class="font-mono"></span>
                    </div>
                    <div class="flex justify-between">
                        <span>Online —Å—Ç–∞—Ç—É—Å:</span>
                        <span id="onlineStatus"></span>
                    </div>
                    <div class="flex justify-between">
                        <span>Service Worker:</span>
                        <span id="swStatus"></span>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4">üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
                <button onclick="testDataLoad()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö
                </button>
                <div id="dataTestResult" class="mt-4 hidden">
                    <pre class="bg-gray-100 p-4 rounded overflow-auto max-h-96"></pre>
                </div>
            </div>

            <!-- –ö—ç—à -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4">üíæ –ö—ç—à</h2>
                <div class="space-y-2">
                    <button onclick="checkCache()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mr-2">
                        üìã –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à
                    </button>
                    <button onclick="clearCache()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
                    </button>
                </div>
                <div id="cacheInfo" class="mt-4 hidden">
                    <pre class="bg-gray-100 p-4 rounded overflow-auto max-h-96"></pre>
                </div>
            </div>

            <!-- –õ–æ–≥–∏ -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4">üìù –õ–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏</h2>
                <button onclick="showConsoleLog()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    üìÑ –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
                </button>
                <div id="consoleLog" class="mt-4 hidden">
                    <pre class="bg-gray-100 p-4 rounded overflow-auto max-h-96"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            // –ë–∞–∑–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
            document.getElementById('dataUrl').textContent = './data.json';
            document.getElementById('onlineStatus').textContent = navigator.onLine ? '‚úÖ Online' : '‚ùå Offline';
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Service Worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.ready.then(() => {
                    document.getElementById('swStatus').textContent = '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω';
                }).catch(() => {
                    document.getElementById('swStatus').textContent = '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω';
                });
            } else {
                document.getElementById('swStatus').textContent = '‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
            }
        });

        // –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        async function testDataLoad() {
            const resultDiv = document.getElementById('dataTestResult');
            resultDiv.classList.remove('hidden');
            
            try {
                console.log('üß™ Starting data load test...');
                
                const response = await fetch('./data.json', {
                    cache: 'no-cache'
                });
                
                const result = {
                    status: response.status,
                    statusText: response.statusText,
                    url: response.url,
                    ok: response.ok,
                    headers: Object.fromEntries(response.headers.entries())
                };
                
                if (response.ok) {
                    const data = await response.json();
                    result.data = data;
                    result.dataSummary = {
                        totalItems: data.length,
                        sampleItem: data[0] || 'No items'
                    };
                }
                
                resultDiv.innerHTML = `<pre class="bg-green-100 p-4 rounded">‚úÖ –£–°–ü–ï–•\n${JSON.stringify(result, null, 2)}</pre>`;
                
            } catch (error) {
                resultDiv.innerHTML = `<pre class="bg-red-100 p-4 rounded">‚ùå –û–®–ò–ë–ö–ê\n${error.toString()}\n\nStack: ${error.stack}</pre>`;
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
        async function checkCache() {
            const cacheInfo = document.getElementById('cacheInfo');
            cacheInfo.classList.remove('hidden');
            
            try {
                const cacheData = localStorage.getItem('products_data');
                const info = {
                    hasCache: !!cacheData,
                    cacheSize: cacheData ? new Blob([cacheData]).size : 0
                };
                
                if (cacheData) {
                    const parsed = JSON.parse(cacheData);
                    info.timestamp = new Date(parsed.timestamp).toLocaleString();
                    info.dataLength = parsed.data ? parsed.data.length : 0;
                    info.sample = parsed.data ? parsed.data[0] : 'No data';
                }
                
                cacheInfo.innerHTML = `<pre class="bg-green-100 p-4 rounded">${JSON.stringify(info, null, 2)}</pre>`;
                
            } catch (error) {
                cacheInfo.innerHTML = `<pre class="bg-red-100 p-4 rounded">‚ùå –û–®–ò–ë–ö–ê: ${error.toString()}</pre>`;
            }
        }

        // –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
        function clearCache() {
            localStorage.removeItem('products_data');
            document.getElementById('cacheInfo').innerHTML = '<pre class="bg-yellow-100 p-4 rounded">üóëÔ∏è –ö—ç—à –æ—á–∏—â–µ–Ω</pre>';
            document.getElementById('cacheInfo').classList.remove('hidden');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏ (—ç–º—É–ª—è—Ü–∏—è)
        function showConsoleLog() {
            const consoleLog = document.getElementById('consoleLog');
            consoleLog.classList.remove('hidden');
            consoleLog.innerHTML = '<pre class="bg-blue-100 p-4 rounded">üìù –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤ –∫–æ–Ω—Å–æ–ª–∏</pre>';
        }
    </script>
</body>
</html>